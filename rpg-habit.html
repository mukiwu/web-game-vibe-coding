<!DOCTYPE html>
<html lang="zh-TW">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>勇者任務冒險 - RPG 習慣養成遊戲</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
  <script src="menu.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&display=swap');

    body {
      font-family: 'Noto Sans TC', monospace;
    }

    .pixel-bg {
      background-color: #1e293b;
    }

    .animate-pulse {
      animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }

    .animate-ping {
      animation: ping 1s cubic-bezier(0, 0, 0.2, 1) infinite;
    }

    .animate-bounce {
      animation: bounce 1s infinite;
    }

    @keyframes pulse {

      0%,
      100% {
        opacity: 1;
      }

      50% {
        opacity: .5;
      }
    }

    @keyframes ping {

      75%,
      100% {
        transform: scale(2);
        opacity: 0;
      }
    }

    @keyframes bounce {

      0%,
      100% {
        transform: translateY(-25%);
        animation-timing-function: cubic-bezier(0.8, 0, 1, 1);
      }

      50% {
        transform: none;
        animation-timing-function: cubic-bezier(0, 0, 0.2, 1);
      }
    }

    .progress-bar {
      transition: width 0.5s ease-in-out;
    }

    .task-item {
      transition: all 0.3s ease-in-out;
    }

    .task-item:hover {
      transform: translateY(-2px);
    }

    .level-up {
      animation: levelUp 0.5s ease-in-out;
    }

    @keyframes levelUp {
      0% {
        transform: scale(1);
      }

      50% {
        transform: scale(1.1);
      }

      100% {
        transform: scale(1);
      }
    }
  </style>
</head>

<body class="min-h-screen text-white pixel-bg">
  <!-- 像素風格背景效果 -->
  <div class="absolute inset-0 opacity-10">
    <div class="absolute top-10 left-10 w-4 h-4 bg-white animate-pulse"></div>
    <div class="absolute top-20 right-20 w-3 h-3 bg-yellow-400 animate-ping"></div>
    <div class="absolute bottom-20 left-20 w-2 h-2 bg-green-400 animate-bounce"></div>
    <div class="absolute bottom-10 right-10 w-5 h-5 bg-pink-400 animate-pulse"></div>
  </div>

  <div class="relative z-10 container mx-auto px-4 py-6">
    <!-- 標題欄 -->
    <div class="flex justify-between items-center mb-6 bg-black bg-opacity-50 rounded-lg p-4 border-2 border-cyan-400">
      <h1 class="text-3xl font-bold text-cyan-400 flex items-center gap-2">
        <i data-lucide="sword" class="text-yellow-400"></i>
        勇者任務冒險
      </h1>
      <button id="parentModeBtn"
        class="px-4 py-2 rounded font-bold border-2 transition-all bg-blue-600 border-blue-400 hover:bg-blue-700">
        <i data-lucide="settings" class="inline mr-2" style="width: 16px; height: 16px;"></i>
        家長模式
      </button>
    </div>

    <!-- 家長管理模式 -->
    <div id="parentMode" class="hidden grid gap-6">
      <div class="bg-black bg-opacity-50 rounded-lg p-6 border-2 border-orange-400">
        <h2 class="text-2xl font-bold text-orange-400 mb-4">📋 任務管理中心</h2>

        <!-- 新增任務 -->
        <div class="bg-gray-800 rounded-lg p-4 mb-6">
          <h3 class="text-lg font-bold text-white mb-3">新增任務</h3>
          <div class="grid md:grid-cols-2 gap-4">
            <input type="text" id="taskName" placeholder="任務名稱"
              class="px-3 py-2 bg-gray-700 text-white rounded border border-gray-600 focus:border-cyan-400">
            <input type="text" id="taskDescription" placeholder="任務描述"
              class="px-3 py-2 bg-gray-700 text-white rounded border border-gray-600 focus:border-cyan-400">
            <input type="number" id="taskReward" placeholder="虛擬幣獎勵" value="10"
              class="px-3 py-2 bg-gray-700 text-white rounded border border-gray-600 focus:border-cyan-400">
            <input type="number" id="taskExpReward" placeholder="經驗值獎勵" value="20"
              class="px-3 py-2 bg-gray-700 text-white rounded border border-gray-600 focus:border-cyan-400">
            <select id="taskDifficulty"
              class="px-3 py-2 bg-gray-700 text-white rounded border border-gray-600 focus:border-cyan-400">
              <option value="easy">簡單</option>
              <option value="medium">中等</option>
              <option value="hard">困難</option>
            </select>
            <select id="taskType"
              class="px-3 py-2 bg-gray-700 text-white rounded border border-gray-600 focus:border-cyan-400">
              <option value="daily">每日任務</option>
              <option value="weekly">每週任務</option>
            </select>
          </div>
          <div class="flex gap-2 mt-4">
            <button id="addTaskBtn"
              class="px-4 py-2 bg-green-600 hover:bg-green-700 rounded font-bold border-2 border-green-400">
              ✅ 新增任務
            </button>
            <button id="resetTasksBtn"
              class="px-4 py-2 bg-yellow-600 hover:bg-yellow-700 rounded font-bold border-2 border-yellow-400">
              🔄 重置所有任務
            </button>
          </div>
        </div>

        <!-- 任務列表 -->
        <div class="bg-gray-800 rounded-lg p-4">
          <h3 class="text-lg font-bold text-white mb-3">目前任務列表</h3>
          <div id="parentTaskList"></div>
        </div>
      </div>
    </div>

    <!-- 遊戲模式 -->
    <div id="gameMode" class="grid lg:grid-cols-3 gap-6">
      <!-- 玩家狀態 -->
      <div class="lg:col-span-1">
        <div class="bg-black bg-opacity-50 rounded-lg p-6 border-2 border-green-400 mb-6">
          <div class="text-center mb-4">
            <div id="playerAvatar" class="text-6xl mb-2">🧙‍♂️</div>
            <h2 id="playerName" class="text-2xl font-bold text-green-400">小勇者</h2>
            <p id="playerLevel" class="text-lg">等級 1</p>
          </div>

          <!-- 狀態條 -->
          <div class="space-y-3">
            <div>
              <div class="flex justify-between text-sm mb-1">
                <span class="flex items-center gap-1">
                  <i data-lucide="heart" class="text-red-400" style="width: 16px; height: 16px;"></i>
                  生命值
                </span>
                <span id="hpDisplay">100/100</span>
              </div>
              <div class="w-full bg-gray-700 rounded-full h-3">
                <div id="hpBar" class="bg-gradient-to-r from-red-500 to-red-400 h-3 rounded-full progress-bar"
                  style="width: 100%"></div>
              </div>
            </div>

            <div>
              <div class="flex justify-between text-sm mb-1">
                <span class="flex items-center gap-1">
                  <i data-lucide="shield" class="text-blue-400" style="width: 16px; height: 16px;"></i>
                  魔法值
                </span>
                <span id="mpDisplay">50/50</span>
              </div>
              <div class="w-full bg-gray-700 rounded-full h-3">
                <div id="mpBar" class="bg-gradient-to-r from-blue-500 to-blue-400 h-3 rounded-full progress-bar"
                  style="width: 100%"></div>
              </div>
            </div>

            <div>
              <div class="flex justify-between text-sm mb-1">
                <span class="flex items-center gap-1">
                  <i data-lucide="star" class="text-purple-400" style="width: 16px; height: 16px;"></i>
                  經驗值
                </span>
                <span id="expDisplay">0/100</span>
              </div>
              <div class="w-full bg-gray-700 rounded-full h-3">
                <div id="expBar" class="bg-gradient-to-r from-purple-500 to-pink-400 h-3 rounded-full progress-bar"
                  style="width: 0%"></div>
              </div>
            </div>
          </div>

          <div class="text-center mt-4 p-3 bg-yellow-600 bg-opacity-20 rounded border border-yellow-400">
            <div class="flex items-center justify-center gap-2 text-2xl font-bold text-yellow-400">
              <i data-lucide="coins" style="width: 24px; height: 24px;"></i>
              <span id="coinsDisplay">50</span> 金幣
            </div>
          </div>
        </div>
      </div>

      <!-- 任務列表 -->
      <div class="lg:col-span-2">
        <div class="bg-black bg-opacity-50 rounded-lg p-6 border-2 border-purple-400">
          <h2 class="text-2xl font-bold text-purple-400 mb-4 flex items-center gap-2">
            <i data-lucide="trophy" style="width: 24px; height: 24px;"></i>
            冒險任務
          </h2>

          <div id="taskList" class="grid gap-4">
            <!-- 任務項目將在這裡動態生成 -->
          </div>

          <div id="allCompletedMessage" class="hidden text-center py-8 text-gray-400">
            <div class="text-6xl mb-4">🎉</div>
            <p class="text-lg">太棒了！所有任務都完成了！</p>
            <p class="text-sm">請等待家長新增更多任務，或者重新開始今天的挑戰！</p>
          </div>
        </div>
      </div>
    </div>
    <div id="footer-anchor"></div>
  </div>

  <script>
    // 遊戲狀態
    let isParentMode = false;
    let playerData = {
      name: '小勇者',
      level: 1,
      exp: 0,
      maxExp: 100,
      coins: 50,
      hp: 100,
      maxHp: 100,
      mp: 50,
      maxMp: 50,
      avatar: '🧙‍♂️'
    };

    let tasks = [
      { id: 1, name: '整理房間', description: '把房間收拾乾淨整齊', reward: 20, expReward: 30, difficulty: 'easy', completed: false, type: 'daily' },
      { id: 2, name: '完成作業', description: '認真完成今天的功課', reward: 30, expReward: 40, difficulty: 'medium', completed: false, type: 'daily' },
      { id: 3, name: '幫忙洗碗', description: '飯後主動幫忙洗碗', reward: 15, expReward: 25, difficulty: 'easy', completed: false, type: 'daily' },
      { id: 4, name: '閱讀30分鐘', description: '專心閱讀課外書籍30分鐘', reward: 25, expReward: 35, difficulty: 'medium', completed: false, type: 'weekly' },
      { id: 5, name: '運動1小時', description: '進行任何形式的運動1小時', reward: 35, expReward: 50, difficulty: 'hard', completed: false, type: 'weekly' }
    ];

    // 計算等級
    function calculateLevel(exp) {
      return Math.floor(exp / 100) + 1;
    }

    // 更新玩家狀態顯示
    function updatePlayerDisplay() {
      document.getElementById('playerName').textContent = playerData.name;
      document.getElementById('playerLevel').textContent = `等級 ${playerData.level}`;
      document.getElementById('playerAvatar').textContent = playerData.avatar;
      document.getElementById('hpDisplay').textContent = `${playerData.hp}/${playerData.maxHp}`;
      document.getElementById('mpDisplay').textContent = `${playerData.mp}/${playerData.maxMp}`;
      document.getElementById('expDisplay').textContent = `${playerData.exp % 100}/${playerData.maxExp}`;
      document.getElementById('coinsDisplay').textContent = playerData.coins;

      // 更新進度條
      document.getElementById('hpBar').style.width = `${(playerData.hp / playerData.maxHp) * 100}%`;
      document.getElementById('mpBar').style.width = `${(playerData.mp / playerData.maxMp) * 100}%`;
      document.getElementById('expBar').style.width = `${((playerData.exp % 100) / 100) * 100}%`;
    }

    // 難度顏色
    function getDifficultyColor(difficulty) {
      switch (difficulty) {
        case 'easy': return 'text-green-600 bg-green-100';
        case 'medium': return 'text-yellow-600 bg-yellow-100';
        case 'hard': return 'text-red-600 bg-red-100';
        default: return 'text-gray-600 bg-gray-100';
      }
    }

    // 任務類型圖標
    function getTaskIcon(type) {
      switch (type) {
        case 'daily': return '📅';
        case 'weekly': return '📊';
        default: return '⭐';
      }
    }

    // 渲染任務列表
    function renderTasks() {
      const taskList = document.getElementById('taskList');
      const parentTaskList = document.getElementById('parentTaskList');
      const allCompletedMessage = document.getElementById('allCompletedMessage');

      // 清空現有內容
      taskList.innerHTML = '';
      parentTaskList.innerHTML = '';

      // 檢查是否所有任務都完成
      const completedTasks = tasks.filter(t => t.completed);
      if (completedTasks.length === tasks.length && tasks.length > 0) {
        allCompletedMessage.classList.remove('hidden');
      } else {
        allCompletedMessage.classList.add('hidden');
      }

      // 渲染遊戲模式的任務
      tasks.forEach(task => {
        const taskElement = document.createElement('div');
        taskElement.className = `task-item p-4 rounded-lg border-2 transition-all duration-300 ${task.completed
          ? 'bg-green-800 bg-opacity-50 border-green-400'
          : 'bg-gray-800 bg-opacity-50 border-gray-600 hover:border-cyan-400 hover:bg-opacity-70'
          }`;

        const difficultyText = task.difficulty === 'easy' ? '簡單' : task.difficulty === 'medium' ? '中等' : '困難';
        const difficultyColor = getDifficultyColor(task.difficulty);

        taskElement.innerHTML = `
                    <div class="flex justify-between items-start mb-2">
                        <div class="flex-1">
                            <div class="flex items-center gap-2 mb-1">
                                <span class="text-2xl">${getTaskIcon(task.type)}</span>
                                <h3 class="text-lg font-bold">${task.name}</h3>
                                <span class="px-2 py-1 rounded-full text-xs font-bold ${difficultyColor}">
                                    ${difficultyText}
                                </span>
                            </div>
                            <p class="text-gray-300 text-sm">${task.description}</p>
                        </div>

                        <div class="text-right ml-4">
                            <div class="text-yellow-400 font-bold mb-1">💰 ${task.reward}</div>
                            <div class="text-blue-400 font-bold">⭐ ${task.expReward}</div>
                        </div>
                    </div>

                    ${!task.completed ?
            `<button onclick="completeTask(${task.id})" class="w-full py-2 bg-gradient-to-r from-green-600 to-green-500 hover:from-green-700 hover:to-green-600 rounded font-bold border-2 border-green-400 transition-all duration-200 transform hover:scale-105">
                            ✅ 完成任務
                        </button>` :
            `<div class="w-full py-2 bg-gray-700 rounded font-bold text-center text-gray-400 border-2 border-gray-500">
                            ✨ 已完成
                        </div>`
          }
                `;

        taskList.appendChild(taskElement);
      });

      // 渲染家長模式的任務
      tasks.forEach(task => {
        const taskElement = document.createElement('div');
        taskElement.className = `p-3 mb-2 rounded border-2 ${task.completed ? 'bg-green-800 border-green-400' : 'bg-gray-700 border-gray-500'
          }`;

        const difficultyText = task.difficulty === 'easy' ? '簡單' : task.difficulty === 'medium' ? '中等' : '困難';
        const difficultyColor = getDifficultyColor(task.difficulty);

        taskElement.innerHTML = `
                    <div class="flex justify-between items-center">
                        <div>
                            <span class="text-lg">${getTaskIcon(task.type)}</span>
                            <span class="font-bold ml-2">${task.name}</span>
                            <span class="ml-2 px-2 py-1 rounded text-xs ${difficultyColor}">
                                ${difficultyText}
                            </span>
                        </div>
                        <div class="text-right">
                            <div class="text-yellow-400">💰 ${task.reward}</div>
                            <div class="text-blue-400">⭐ ${task.expReward}</div>
                        </div>
                    </div>
                `;

        parentTaskList.appendChild(taskElement);
      });
    }

    // 完成任務
    function completeTask(taskId) {
      const task = tasks.find(t => t.id === taskId);
      if (task && !task.completed) {
        task.completed = true;

        const newExp = playerData.exp + task.expReward;
        const newLevel = calculateLevel(newExp);
        const leveledUp = newLevel > playerData.level;

        playerData.coins += task.reward;
        playerData.exp = newExp;
        playerData.level = newLevel;
        playerData.maxExp = newLevel * 100;

        if (leveledUp) {
          playerData.maxHp += 10;
          playerData.hp = playerData.maxHp;
          playerData.maxMp += 5;
          playerData.mp = playerData.maxMp;

          // 等級提升動畫
          document.getElementById('playerLevel').classList.add('level-up');
          setTimeout(() => {
            document.getElementById('playerLevel').classList.remove('level-up');
          }, 500);

          setTimeout(() => {
            alert(`🎉 恭喜升級！等級提升至 ${newLevel}！獲得生命值和魔法值提升！`);
          }, 100);
        }

        updatePlayerDisplay();
        renderTasks();
      }
    }

    // 新增任務
    function addTask() {
      const name = document.getElementById('taskName').value.trim();
      const description = document.getElementById('taskDescription').value.trim();
      const reward = parseInt(document.getElementById('taskReward').value) || 0;
      const expReward = parseInt(document.getElementById('taskExpReward').value) || 0;
      const difficulty = document.getElementById('taskDifficulty').value;
      const type = document.getElementById('taskType').value;

      if (name) {
        const task = {
          id: Date.now(),
          name,
          description,
          reward,
          expReward,
          difficulty,
          type,
          completed: false
        };

        tasks.push(task);

        // 清空表單
        document.getElementById('taskName').value = '';
        document.getElementById('taskDescription').value = '';
        document.getElementById('taskReward').value = '10';
        document.getElementById('taskExpReward').value = '20';
        document.getElementById('taskDifficulty').value = 'easy';
        document.getElementById('taskType').value = 'daily';

        renderTasks();
      }
    }

    // 重置任務
    function resetTasks() {
      tasks.forEach(task => {
        task.completed = false;
      });
      renderTasks();
    }

    // 切換家長模式
    function toggleParentMode() {
      isParentMode = !isParentMode;
      const parentMode = document.getElementById('parentMode');
      const gameMode = document.getElementById('gameMode');
      const parentModeBtn = document.getElementById('parentModeBtn');

      if (isParentMode) {
        parentMode.classList.remove('hidden');
        gameMode.classList.add('hidden');
        parentModeBtn.innerHTML = '<i data-lucide="settings" class="inline mr-2" style="width: 16px; height: 16px;"></i>返回遊戲';
        parentModeBtn.className = 'px-4 py-2 rounded font-bold border-2 transition-all bg-red-600 border-red-400 hover:bg-red-700';
      } else {
        parentMode.classList.add('hidden');
        gameMode.classList.remove('hidden');
        parentModeBtn.innerHTML = '<i data-lucide="settings" class="inline mr-2" style="width: 16px; height: 16px;"></i>家長模式';
        parentModeBtn.className = 'px-4 py-2 rounded font-bold border-2 transition-all bg-blue-600 border-blue-400 hover:bg-blue-700';
      }

      // 重新初始化 Lucide 圖標
      lucide.createIcons();
    }

    // 事件監聽器
    document.addEventListener('DOMContentLoaded', function () {
      // 初始化 Lucide 圖標
      lucide.createIcons();

      // 綁定事件
      document.getElementById('parentModeBtn').addEventListener('click', toggleParentMode);
      document.getElementById('addTaskBtn').addEventListener('click', addTask);
      document.getElementById('resetTasksBtn').addEventListener('click', resetTasks);

      // 初始化顯示
      updatePlayerDisplay();
      renderTasks();
    });
  </script>
  <script src="footer.js"></script>
</body>

</html>
